<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    
    
    <link rel="shortcut icon" href="../img/favicon.ico">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>Upgrade - Administration Guide</title>
    <link href="../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="../css/highlight.css">
    <link href="../css/extra.css" rel="stylesheet">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="../js/jquery-3.2.1.min.js"></script>
    <script src="../js/bootstrap-3.3.7.min.js"></script>
    <script src="../js/highlight.pack.js"></script>
    
    <base target="_top">
    <script>
      var base_url = '..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "Upgrading Opencast from 8.x to 9.x", url: "#_top", children: [
              {title: "Install and configure a standalone Elasticsearch node", url: "#install-and-configure-a-standalone-elasticsearch-node" },
              {title: "Rebuild the Elasticsearch Indexes", url: "#rebuild-the-elasticsearch-indexes" },
          ]},
        ];

    </script>
    <script src="../js/base.js"></script>
      <script src="../javascript/extra.js"></script> 
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
  <a name="_top"></a>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../changelog/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../changelog/" class="btn btn-xs btn-link">
        Changelog
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../releasenotes/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../releasenotes/" class="btn btn-xs btn-link">
        Release Notes
      </a>
    </div>
    
  </div>

    

    <h1 id="upgrading-opencast-from-8x-to-9x">Upgrading Opencast from 8.x to 9.x</h1>
<p>This guide describes how to upgrade Opencast 8.x to 9.x. In case you need information about how to upgrade older
versions of Opencast, please refer to <a href="https://docs.opencast.org">older release notes</a>.</p>
<ol>
<li>Stop your current Opencast instance</li>
<li>Replace Opencast with the new version</li>
<li>Back-up Opencast files and database (optional)</li>
<li>Upgrade the database</li>
<li><a href="#install-and-confifure-a-standalone-elasticsearch-node">Install and configure a standlone Elasticsearch node</a></li>
<li><a href="#configuration-changes">Review the configuration changes and adjust your configuration accordingly</a></li>
<li>Remove search index data folder</li>
<li>Start Opencast</li>
<li><a href="#rebuild-the-elasticsearch-indexes">Rebuild the Elasticsearch indexes</a></li>
</ol>
<h2 id="install-and-configure-a-standalone-elasticsearch-node">Install and configure a standalone Elasticsearch node</h2>
<p>In the past, Opencast came with its own integrated Elasticsearch node. However, recent versions of Elasticsearch no longer
support to be embedded in applications. Since the Elasticsearch client was updated to version 7, Opencast now requires an
external Elasticsearch node of the same version to be present. This means, that all Opencast adopters now have to run
Elasticsearch.</p>
<p>Please check <a href="../modules/searchindex/elasticsearch/">the documentation</a> for information about how to setup an external node.</p>
<p>If you already used an external Elasticsearch node in the past, please update your node to version 7. Since the index
schema has changed, you will need to drop you indices and <a href="#rebuild-the-elasticsearch-indexes">rebuild them</a>.</p>
<h2 id="rebuild-the-elasticsearch-indexes">Rebuild the Elasticsearch Indexes</h2>
<p>In order to populate the external Elasticsearch index, an index rebuild is necessary.</p>
<h3 id="admin-interface">Admin Interface</h3>
<p>Stop Opencast, delete the index directory at <code>data/index</code>, restart Opencast and make an HTTP POST request to
<code>/admin-ng/index/recreateIndex</code>.</p>
<p>Example (using cURL):</p>
<pre><code>curl -i --digest -u &lt;digest_user&gt;:&lt;digest_password&gt; -H "X-Requested-Auth: Digest" -s -X POST \
  https://example.opencast.org/admin-ng/index/recreateIndex
</code></pre>
<p>You can also just open the REST documentation, which can be found under the “Help” section in the admin interface (the
“?” symbol at the top right corner). Then go to the “Admin UI - Index Endpoint” section and use the testing form on
<code>/recreateIndex</code> to issue a POST request.</p>
<p>In both cases you should get a 200 HTTP status.</p>
<h3 id="external-api">External API</h3>
<p>If you are using the External API, then also trigger a rebuilt of its index by sending an HTTP POST request to
<code>/api/recreateIndex</code>.</p>
<p>Example (using cURL):</p>
<pre><code>curl -i --digest -u &lt;digest_user&gt;:&lt;digest_password&gt; -H "X-Requested-Auth: Digest" -s -X POST \
  https://example.opencast.org/api/recreateIndex
</code></pre>
<p>You can also just open the REST documentation, which can be found under the “Help” section in the admin interface (the
“?” symbol at the top right corner). Then go to the “External API - Base Endpoint” section and use the testing form on
<code>/recreateIndex</code>.</p>
<p>In both cases you should again get a 200 HTTP status.</p>

  <br>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../changelog/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../changelog/" class="btn btn-xs btn-link">
        Changelog
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../releasenotes/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../releasenotes/" class="btn btn-xs btn-link">
        Release Notes
      </a>
    </div>
    
  </div>

    <br>
</div>

<footer class="col-md-12 wm-page-content">
      <p>
        <a href="https://github.com/opencast/opencast/edit/develop/docs/guides/admin/docs/upgrade.md"><i class="fa fa-github"></i>
Edit on GitHub</a>
      </p>
  <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a> using <a href="https://github.com/gristlabs/mkdocs-windmill">Windmill</a> theme by Grist Labs.</p>
</footer>

</body>
</html>